#| include: false
#| warning: false
#| message: false
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(lme4)
library(lmerTest)
library(patchwork)
library(knitr)
library(kableExtra)
# Helper function
stats_table <- function(model, title) {
res <- anova(model)
kable(res, caption=title, digits=3) %>% kable_styling(full_width=F)
}
df <- read_csv("data/master_data.csv")
# A. Inventory
pool_stats <- df %>% group_by(Trt) %>%
summarise(Micro=mean(Micro_P, na.rm=T), Soil=mean(Soil_P, na.rm=T))
# Graph 1: The Microbial Lockout
df %>% pivot_longer(c(Soil_P, Micro_P), names_to="Pool", values_to="Val") %>%
ggplot(aes(x=Pool, y=Val, fill=Trt)) +
stat_summary(fun=mean, geom="bar", position="dodge") +
stat_summary(fun.data=mean_se, geom="errorbar", position=position_dodge(0.9), width=0.2) +
labs(title="Mechanism: Microbial Pre-emption", y="g P / m2") +
theme_classic() + scale_fill_manual(values=c("#A6CEE3", "#1F78B4"))
# Graph 2: Stagnation
ggplot(df, aes(x=Year, y=Wood_C, color=Trt)) +
stat_summary(fun=mean, geom="line", size=1) +
stat_summary(fun.data=mean_se, geom="errorbar", width=0.1) +
labs(title="Effect: Biomass Stagnation", y="Wood Carbon (g/m2)") +
scale_color_manual(values=c("black", "red")) + theme_bw()
# Stats
m_wood <- lmer(Wood_C ~ Trt * as.factor(Year) + (1|Ring), data=df)
stats_table(m_wood, "Wood Carbon ANOVA")
ggplot(df, aes(x=Year, y=Root_Shoot, color=Trt)) +
stat_summary(fun=mean, geom="line", size=1) +
stat_summary(fun.data=mean_se, geom="errorbar", width=0.1) +
labs(title="Adaptation 1: Root Foraging Investment", y="Root : Wood Ratio") +
scale_color_manual(values=c("black", "red")) + theme_classic()
df_clean <- df %>% filter(!is.na(GPP))
ggplot(df_clean, aes(x=Soil_P, y=GPP, color=Trt)) +
geom_point(alpha=0.6) +
geom_smooth(method="lm", se=TRUE, fill="grey80") +
labs(title="Adaptation 2: Physiological Efficiency",
subtitle="eCO2 (Red) maintains higher productivity at low P",
x="Available Soil P", y="Carbon Uptake (GPP)") +
scale_color_manual(values=c("black", "red")) + theme_classic()
# Stats for PUE
m_pue <- lmer(GPP ~ Soil_P * Trt + (1|Ring), data=df_clean)
kable(summary(m_pue)$coefficients, caption="Effect of Treatment on Efficiency")
---
title: "Microbial Competition & Tree Adaptations"
